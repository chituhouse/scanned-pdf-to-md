---
name: cross-validate-ocr
description: OCR交叉验证 - 对比纯OCR版和文档解析版MD文档，逐套题验证，补齐缺失内容，清除干扰内容。当用户需要进行OCR交叉验证时使用此技能。
---

# OCR交叉验证 Skill

对比纯OCR版和文档解析版MD文档，逐套题交叉验证，补齐缺失内容，清除干扰内容。

## 输入文件

- 纯OCR版：`output/公共营养师三级历年真题_纯OCR版.md`
- 文档解析版：`output/公共营养师三级历年真题_文档解析版.md`

## 工作流程

### 第一步：分割套题

按年份+月份识别每套考试的边界，使用正则匹配：
```
(20\d{2})\s*年\s*(\d+)\s*月.*?(?:公共营养师|统考|真题)
```

分割为独立单元（约20套）：
- 2025年6月统考真题
- 2025年6月答案解析
- 2025年3月统考真题
- ...

### 第二步：逐套交叉验证

**重要：必须一套一套处理，绝对不能批量处理！每套处理完必须展示报告给用户确认！**

**什么是交叉验证：**
- 同时读取纯OCR版和文档解析版的同一套题
- 逐题对比两个版本，发现差异
- **合并两个版本的内容，生成一套完整的试题**
- 不是"选择用哪个版本"，而是"合并成一份完整的"
- 最终输出：格式正确、内容完整的试题

**最终目标：**
生成一套完整的试题，包含：
- 完整的题目文本
- 完整的A/B/C/D选项
- 正确的格式（题号、选项换行等）
- 无干扰内容（水印已清除）

**处理流程（每套题必须执行）：**

#### 2.1 逐题合并
对每道题执行：
1. 从纯OCR版提取题目内容
2. 从文档解析版提取同一题内容
3. **合并生成完整题目**：
   - 题目文本：取更完整的一版，或合并两版
   - 选项A：对比两版，取有内容的
   - 选项B：对比两版，取有内容的
   - 选项C：对比两版，取有内容的
   - 选项D：对比两版，取有内容的
4. 输出格式：
   ```
   X.题目文本（）
   A.选项A内容
   B.选项B内容
   C.选项C内容
   D.选项D内容
   ```

#### 2.2 选项补齐
- 纯OCR版有选项D但文档解析版没有 → 使用纯OCR版的选项D
- 文档解析版有选项A但纯OCR版没有 → 使用文档解析版的选项A
- 两版都没有某选项 → 标注 `[选项X缺失]`
- 记录：`第X题：从纯OCR版补齐选项D`

#### 2.3 题目补齐
- 一版有完整题目，另一版缺失 → 使用有的那版
- 两版都缺失 → 标注 `[第X题缺失]`
- 记录：`第X题：从纯OCR版补齐整题`

#### 2.4 干扰内容清除
必须删除的干扰内容：
- `小象教育`
- `抖音`
- `douyin`
- `www.`
- `http`
- 单独成行的数字页码
- 明显的水印文字
- 记录：`第X题：删除干扰内容"小象教育"`

#### 2.5 括号配对检查
- 检测单边括号
- 尝试从另一版本获取正确的括号配对
- 记录：`第X题：修复括号配对`

#### 2.6 表格处理
- 保留文档解析版的 Markdown 表格格式（以 `|` 开头的行）
- 如果文档解析版表格不完整，参考纯OCR版补充
- 记录：`第X页：使用文档解析版表格`

#### 2.7 展示报告并等待确认
每套题处理完成后：
1. 展示验证报告（统计、修复记录、待确认项）
2. 等待用户确认
3. 用户确认后才能继续下一套

### 第三步：输出单套验证结果

每套题处理完成后，输出到独立文件：
```
output/validated/
├── 01_2025-06_真题.md
├── 02_2025-06_答案.md
├── 03_2025-03_真题.md
├── 04_2025-03_答案.md
└── ...
```

每个文件包含：
1. 验证报告（修复记录、待确认项）
2. 验证后的完整内容

### 第四步：合并最终文档

所有套题验证完成后，合并为：
```
output/公共营养师三级历年真题_验证版.md
```

## 验证规则（必须严格遵守）

### 铁律
1. **不发挥、不编造**：只使用两个MD文档中已有的内容
2. **不猜测答案**：如果两版都没有某内容，标注 `[缺失]` 而不是编造
3. **保留原文**：修复格式问题，但不修改题目文字本身

### 优先级规则
| 内容类型 | 优先采用 | 原因 |
|:---|:---|:---|
| 表格 | 文档解析版 | Markdown格式更好 |
| 选项文本 | 文档解析版 | 换行更准确 |
| 题目文本 | 对比取更完整的 | 两版各有优劣 |
| 题号 | 纯OCR版 | 识别更稳定 |

### 冲突处理
当两版内容明显不一致时：
- 保留两者内容
- 添加标注：`[待人工确认：版本A为xxx，版本B为yyy]`
- 记录到验证报告中

## 输出格式

### 单套题验证报告格式

```markdown
# [年份]年[月份]月公共营养师三级[真题/答案解析]

## 验证报告

### 统计
- 总题数：XX
- 修复项：XX
- 待确认：XX

### 修复记录
1. 第X题：补齐选项D（来源：纯OCR版）
2. 第Y题：删除干扰内容"小象教育"
3. 第Z题：修复括号配对

### 待人工确认
1. 第W题：两版选项B内容不一致
   - 纯OCR版：xxx
   - 文档解析版：yyy

---

## 正文内容

[验证后的完整题目内容...]
```

## 调用示例

用户输入：`/cross-validate-ocr`

执行流程：
1. 读取两个MD文件
2. 识别并列出所有套题
3. 询问用户：从第几套开始？（默认从第1套）
4. 逐套处理，每套完成后输出报告
5. 全部完成后合并

## 注意事项

- 每处理完一套题，暂停并展示验证报告
- 用户确认后再继续下一套
- 如遇大量问题，建议分批处理
- 保持耐心，质量优先于速度
